<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CreatorCalc - Aurora Edition</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        display: ['Outfit', 'sans-serif']
                    },
                    colors: {
                        primary: '#ef4444',
                        border: "hsl(var(--border))",
                        input: "hsl(var(--input))",
                        ring: "hsl(var(--ring))",
                        background: "hsl(var(--background))",
                        foreground: "hsl(var(--foreground))",
                    },
                    boxShadow: {
                        'glass': '0 8px 30px rgba(0,0,0,0.12)',
                        'glow': '0 0 15px rgba(239, 68, 68, 0.5)',
                    }
                }
            }
        }
    </script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800;900&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --background: 220 33% 98%;
            --foreground: 222 47% 11%;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --glass-blur: 16px;
        }

        .dark {
            --background: 225 6% 13%;
            --foreground: 210 40% 98%;
            --glass-bg: rgba(30, 41, 59, 0.4);
            --glass-border: rgba(255, 255, 255, 0.08);
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            overflow-x: hidden;
            transition: background-color 0.5s ease;
        }

        /* Aurora Background */
        .aurora-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background:
                radial-gradient(at 0% 0%, rgba(239, 68, 68, 0.4) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(168, 85, 247, 0.4) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(245, 158, 11, 0.3) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(16, 185, 129, 0.3) 0px, transparent 50%);
            filter: blur(80px) saturate(150%);
            opacity: 0.6;
            animation: auroraMove 20s ease-in-out infinite alternate;
        }

        .dark .aurora-bg {
            opacity: 0.3;
            background:
                radial-gradient(at 0% 0%, rgba(239, 68, 68, 0.5) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(168, 85, 247, 0.5) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(245, 158, 11, 0.4) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(16, 185, 129, 0.4) 0px, transparent 50%);
        }

        @keyframes auroraMove {
            0% {
                transform: scale(1) translate(0, 0);
            }

            33% {
                transform: scale(1.1) translate(-20px, 10px);
            }

            66% {
                transform: scale(0.95) translate(20px, -10px);
            }

            100% {
                transform: scale(1.05) translate(0, 0);
            }
        }

        /* Enhanced Glass Card */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
            border-radius: 1.5rem;
            border-radius: 1.5rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        /* Spotlight Effect */
        .glass-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            background: radial-gradient(800px circle at var(--x, 0px) var(--y, 0px),
                    rgba(255, 255, 255, 0.1),
                    transparent 40%);
            z-index: 1;
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
        }

        .glass-card:hover::before {
            opacity: 1;
        }

        .glass-card>* {
            position: relative;
            z-index: 2;
        }

        .dark .glass-card {
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .glass-card:hover {
            transform: translateY(-5px) scale(1.005);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
        }

        /* Input Glass */
        .input-glass {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dark .input-glass {
            background: rgba(15, 23, 42, 0.6);
            border-color: rgba(255, 255, 255, 0.08);
        }

        .input-glass:focus {
            background: rgba(255, 255, 255, 0.9);
            border-color: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
            transform: translateY(-2px);
        }

        .dark .input-glass:focus {
            background: rgba(9, 13, 24, 0.9);
        }

        /* Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none;
            background: transparent;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #ef4444;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: rgba(156, 163, 175, 0.3);
            border-radius: 2px;
        }

        .gradient-text {
            background: linear-gradient(to right, #ff7171, #ffcb7d);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 15px rgba(239, 68, 68, 0.4));
        }

        .gradient-text-green {
            background: linear-gradient(to right, #4ade80, #22c55e);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 15px rgba(34, 197, 94, 0.4));
        }

        .text-glow {
            text-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }

        /* Animations */
        .animate-enter {
            animation: fadeUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        @keyframes fadeUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce-up {
            0% {
                transform: translateY(15px);
                opacity: 0;
            }

            50% {
                transform: translateY(-3px);
            }

            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .animate-bounce-up {
            animation: bounce-up 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .truncate-value {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(156, 163, 175, 0.5);
            border-radius: 10px;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: rgba(31, 41, 55, 0.8);
        }
    </style>
</head>

<body class="min-h-screen px-4 py-8 md:px-8 dark selection:bg-red-500/30">
    <div class="main" id="star-layer"></div>
    <div class="aurora-bg"></div>

    <div class="max-w-6xl mx-auto space-y-10 pb-20">

        <!-- Header -->
        <header class="sticky top-0 z-50 flex items-center justify-between animate-enter backdrop-blur-lg bg-white/30 dark:bg-gray-900/30 -mx-4 px-4 md:-mx-8 md:px-8 py-4 border-b border-gray-200/10 dark:border-white/5 transition-all duration-300" style="animation-delay: 0.1s;">
            <div class="flex items-center gap-4">
                <div
                    class="w-12 h-12 rounded-2xl bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center shadow-glow shadow-red-500/30">
                    <i data-lucide="zap" class="text-white w-6 h-6"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-black tracking-tight text-gray-900 dark:text-white">CreatorCalc</h1>
                    <p class="text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em]">Aurora Edition</p>
                </div>
            </div>

            <button onclick="toggleTheme()"
                class="p-3 glass-card rounded-xl hover:scale-105 active:scale-95 transition-all">
                <i data-lucide="moon" id="theme-icon" class="w-5 h-5 text-gray-600 dark:text-gray-300"></i>
            </button>
        </header>

        <!-- Calculator Section -->
        <div class="glass-card p-8 md:p-12 space-y-10 relative overflow-hidden animate-enter"
            style="animation-delay: 0.2s;">
            <div
                class="absolute top-0 right-0 w-96 h-96 bg-red-500/5 -mr-48 -mt-48 rounded-full blur-[100px] pointer-events-none">
            </div>

            <div class="flex flex-col md:flex-row md:items-center justify-between gap-6 relative z-10">
                <div>
                    <h2 class="text-2xl font-black tracking-tight text-gray-900 dark:text-white">เครื่องคำนวณรายได้</h2>
                    <p class="text-sm text-gray-400 font-medium">วางแผนอิสรภาพทางการเงินจากยอดวิวของคุณ</p>
                </div>

                <div
                    class="flex bg-gray-100/50 dark:bg-black/20 p-1.5 rounded-xl border border-gray-200/50 dark:border-white/5 backdrop-blur-sm">
                    <button onclick="setCurrency('THB')" id="btn-thb"
                        class="px-6 py-2 rounded-lg text-sm font-bold transition-all shadow-sm">THB</button>
                    <button onclick="setCurrency('USD')" id="btn-usd"
                        class="px-6 py-2 rounded-lg text-sm font-bold transition-all text-gray-400">USD</button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 relative z-10">
                <div class="space-y-3 group">
                    <label
                        class="text-xs font-bold text-gray-400 uppercase tracking-wider flex items-center gap-2 group-focus-within:text-red-500 transition-colors">
                        <i data-lucide="video" class="w-3.5 h-3.5"></i> จำนวนคลิป / วัน
                    </label>
                    <input type="text" id="input-videos" value="1" oninput="handleInput('videos', this.value)"
                        class="w-full px-5 py-4 input-glass rounded-xl outline-none text-2xl font-black text-gray-900 dark:text-white placeholder-gray-300">
                </div>

                <div class="space-y-3 group">
                    <label
                        class="text-xs font-bold text-gray-400 uppercase tracking-wider flex items-center gap-2 group-focus-within:text-red-500 transition-colors">
                        <i data-lucide="eye" class="w-3.5 h-3.5"></i> ยอดวิวเฉลี่ย
                    </label>
                    <input type="text" id="input-views" value="10,000" oninput="handleInput('views', this.value)"
                        class="w-full px-5 py-4 input-glass rounded-xl outline-none text-2xl font-black text-gray-900 dark:text-white placeholder-gray-300">
                </div>

                <div class="space-y-3 group">
                    <label
                        class="text-xs font-bold text-gray-400 uppercase tracking-wider flex items-center gap-2 group-focus-within:text-red-500 transition-colors">
                        <i data-lucide="dollar-sign" class="w-3.5 h-3.5"></i> RPM (<span
                            id="rpm-currency-label">THB</span>)
                    </label>
                    <input type="text" id="input-rpm" value="6" oninput="handleInput('rpm', this.value)"
                        class="w-full px-5 py-4 input-glass rounded-xl outline-none text-2xl font-black text-gray-900 dark:text-white placeholder-gray-300">
                </div>
            </div>
        </div>

        <!-- Results Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="results-grid">
            <div class="glass-card p-8 space-y-2 animate-enter" style="animation-delay: 0.3s;">
                <div class="flex items-center gap-3 mb-4">
                    <div
                        class="w-10 h-10 rounded-full bg-gray-100 dark:bg-white/5 flex items-center justify-center text-gray-400">
                        <i data-lucide="clock" class="w-5 h-5"></i>
                    </div>
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-wider">รายวัน</p>
                </div>
                <h3 id="res-daily" class="text-2xl font-black text-gray-900 dark:text-white truncate-value">฿0.00</h3>
                <div class="space-y-1 pt-4 border-t border-gray-200/50 dark:border-white/5 mt-4">
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-gray-400">Total Views</span>
                        <span id="res-daily-views" class="text-sm font-bold text-gray-600 dark:text-gray-300">0</span>
                    </div>
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-gray-400">Active RPM</span>
                        <span id="res-daily-rpm" class="text-sm font-bold text-gray-600 dark:text-gray-300">0</span>
                    </div>
                </div>
            </div>

            <div class="glass-card p-8 space-y-2 relative overflow-hidden animate-enter" style="animation-delay: 0.4s;">
                <div class="absolute top-0 right-0 w-20 h-20 bg-red-500/10 rounded-bl-full -mr-4 -mt-4"></div>
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-full bg-red-500/10 flex items-center justify-center text-red-500">
                        <i data-lucide="calendar" class="w-5 h-5"></i>
                    </div>
                    <p class="text-xs font-bold text-red-500 uppercase tracking-wider">รายเดือน</p>
                </div>
                <h3 id="res-monthly" class="text-3xl font-black text-gray-900 dark:text-white truncate-value">฿0.00</h3>
                <div class="space-y-1 pt-4 border-t border-gray-200/50 dark:border-white/5 mt-4">
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-red-400/70">Total Views</span>
                        <span id="res-monthly-views" class="text-sm font-bold text-gray-600 dark:text-gray-300">0</span>
                    </div>
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-red-400/70">Videos Created</span>
                        <span id="res-monthly-videos"
                            class="text-sm font-bold text-gray-600 dark:text-gray-300">0</span>
                    </div>
                </div>
            </div>

            <div class="glass-card p-8 space-y-2 animate-enter" style="animation-delay: 0.5s;">
                <div class="flex items-center gap-3 mb-4">
                    <div
                        class="w-10 h-10 rounded-full bg-gray-100 dark:bg-white/5 flex items-center justify-center text-gray-400">
                        <i data-lucide="trending-up" class="w-5 h-5"></i>
                    </div>
                    <p class="text-xs font-bold text-gray-400 uppercase tracking-wider">รายปี</p>
                </div>
                <h3 id="res-annual" class="text-2xl font-black text-gray-900 dark:text-white truncate-value">฿0.00</h3>
                <div class="space-y-1 pt-4 border-t border-gray-200/50 dark:border-white/5 mt-4">
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-gray-400">Total Views</span>
                        <span id="res-annual-views" class="text-sm font-bold text-gray-600 dark:text-gray-300">0</span>
                    </div>
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-gray-400">Videos Created</span>
                        <span id="res-annual-videos" class="text-sm font-bold text-gray-600 dark:text-gray-300">0</span>
                    </div>
                </div>
            </div>

            <div class="glass-card p-8 space-y-2 bg-gradient-to-br from-purple-500/5 to-transparent animate-enter"
                style="animation-delay: 0.6s;">
                <div class="flex items-center gap-3 mb-4">
                    <div
                        class="w-10 h-10 rounded-full bg-purple-500/10 flex items-center justify-center text-purple-500">
                        <i data-lucide="receipt" class="w-5 h-5"></i>
                    </div>
                    <p class="text-xs font-bold text-purple-500 uppercase tracking-wider">ภาษีโดยประมาณ</p>
                </div>
                <div class="space-y-1">
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-gray-400">แบบขั้นบันได</span>
                        <h3 id="res-tax-progressive" class="text-xl font-black text-purple-500 truncate-value">฿0.00
                        </h3>
                    </div>
                    <div class="h-px bg-gray-200 dark:bg-white/10"></div>
                    <div class="flex justify-between items-end">
                        <span class="text-xs text-gray-400">Effective Rate</span>
                        <h3 id="res-tax-effective"
                            class="text-lg font-bold text-gray-500 dark:text-gray-400 truncate-value">0%</h3>
                    </div>
                    <div class="pt-1 text-[10px] text-gray-400 text-right">
                        *หักลดหย่อน 119k
                    </div>
                </div>
            </div>
        </div>

        <!-- Allocation Section -->
        <div class="space-y-8 py-8 animate-enter" style="animation-delay: 0.7s;">
            <div class="flex items-center justify-center gap-6">
                <div class="h-px w-24 bg-gradient-to-r from-transparent to-gray-200 dark:to-white/10 hidden md:block">
                </div>
                <div class="text-center">
                    <h2 class="text-2xl font-black tracking-tight text-gray-900 dark:text-white">กฎ 10-5-85</h2>
                    <p class="text-sm text-gray-400 font-medium">สูตรสำเร็จจัดสรรรายได้สู่ความมั่งคั่ง</p>
                </div>
                <div class="h-px w-24 bg-gradient-to-l from-transparent to-gray-200 dark:to-white/10 hidden md:block">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Salary -->
                <div class="glass-card p-8 space-y-6 hover:border-blue-500/30 transition-colors group">
                    <div class="flex justify-between items-start">
                        <div
                            class="p-3 bg-blue-500/10 text-blue-500 rounded-xl group-hover:scale-110 transition-transform">
                            <i data-lucide="wallet" class="w-6 h-6"></i>
                        </div>
                        <span
                            class="text-4xl font-black opacity-20 text-blue-500 group-hover:opacity-40 transition-opacity">10%</span>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white">เงินเดือนส่วนตัว</h3>
                        <div id="alloc-salary"
                            class="text-2xl font-black text-gray-900 dark:text-white truncate-value mt-1">฿0.00</div>
                    </div>
                </div>

                <!-- Growth -->
                <div class="glass-card p-8 space-y-6 hover:border-orange-500/30 transition-colors group">
                    <div class="flex justify-between items-start">
                        <div
                            class="p-3 bg-orange-500/10 text-orange-500 rounded-xl group-hover:scale-110 transition-transform">
                            <i data-lucide="wrench" class="w-6 h-6"></i>
                        </div>
                        <span
                            class="text-4xl font-black opacity-20 text-orange-500 group-hover:opacity-40 transition-opacity">5%</span>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white">งบพัฒนาระบบ</h3>
                        <div id="alloc-growth"
                            class="text-2xl font-black text-gray-900 dark:text-white truncate-value mt-1">฿0.00</div>
                    </div>
                </div>

                <!-- Investment -->
                <div class="glass-card p-8 space-y-6 border-green-500/20 bg-green-500/5 group">
                    <div class="flex justify-between items-start">
                        <div
                            class="p-3 bg-green-500/10 text-green-500 rounded-xl group-hover:scale-110 transition-transform">
                            <i data-lucide="trending-up" class="w-6 h-6"></i>
                        </div>
                        <span
                            class="text-4xl font-black opacity-30 text-green-500 group-hover:opacity-50 transition-opacity">85%</span>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white">กองทุนความมั่งคั่ง</h3>
                        <div id="alloc-investment" class="text-2xl font-black text-green-500 truncate-value mt-1">฿0.00
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Passive Income Goal Card -->
        <div class="glass-card p-10 md:p-14 text-center space-y-8 relative overflow-hidden animate-enter"
            style="animation-delay: 0.8s;">
            <div
                class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-green-500/[0.03] rounded-full blur-[100px] pointer-events-none">
            </div>

            <div class="relative z-10 space-y-6 max-w-2xl mx-auto">
                <div
                    class="inline-flex items-center gap-2 px-4 py-2 bg-green-500/10 text-green-500 rounded-full text-[10px] font-black uppercase tracking-[0.2em] shadow-sm">
                    <i data-lucide="shield-check" class="w-3 h-3"></i> กฎ 4%
                </div>

                <div class="space-y-4">
                    <div>
                        <h2 class="text-4xl md:text-6xl font-black tracking-tighter text-gray-900 dark:text-white">
                            <span id="passive-income" class="gradient-text-green text-5xl md:text-7xl">฿0.00</span>
                            <span class="text-xl md:text-2xl text-gray-400 font-bold">/เดือน</span>
                        </h2>
                        <p class="text-sm text-gray-500 mt-2">
                            รายได้ Passive Income ในอีก <span id="years-display"
                                class="font-bold text-gray-900 dark:text-white">10</span> ปีข้างหน้า
                        </p>
                    </div>

                    <!-- Range Slider -->
                    <div class="pt-6 pb-2 px-4 max-w-sm mx-auto">
                        <div
                            class="flex justify-between text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">
                            <span>1 ปี</span>
                            <span>ระยะเวลาลงทุน</span>
                            <span>30 ปี</span>
                        </div>
                        <input type="range" id="years-slider" min="1" max="30" value="10"
                            oninput="handleYearChange(this.value)" class="w-full">
                    </div>
                </div>
            </div>

            <!-- Chart Container -->
            <div class="relative z-10 h-64 mt-8 w-full max-w-3xl mx-auto">
                <canvas id="wealthChart"></canvas>
            </div>

            <div class="grid grid-cols-2 gap-8 relative z-10 border-t border-gray-200/50 dark:border-white/5 pt-8 mt-8">
                <div>
                    <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1">ความมั่งคั่งรวม</p>
                    <div id="total-wealth-Future"
                        class="text-xl md:text-2xl font-black text-gray-900 dark:text-white truncate-value">฿0.00</div>
                </div>
                <div>
                    <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1">การเติบโต</p>
                    <div id="growth-percent" class="text-xl md:text-2xl font-black text-green-500">+100%</div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center space-y-6 pt-10 animate-enter" style="animation-delay: 0.9s;">
            <div class="flex items-center justify-center gap-4 opacity-50">
                <div class="h-px w-12 bg-current"></div>
                <div class="w-1.5 h-1.5 rounded-full bg-current"></div>
                <div class="h-px w-12 bg-current"></div>
            </div>
            <p class="text-sm font-bold text-gray-500 dark:text-gray-400">© 2026 Precision Built by Suphakrit</p>
        </footer>
    </div>

    <script>
        // --- Core Data ---
        let currentCurrency = 'THB';
        let exchangeRate = 31.59;
        let inputs = { videos: 1, views: 10000, rpm: 6, years: 10 };
        let currentValues = {
            daily: 0, monthly: 0, annual: 0,
            daily: 0, monthly: 0, annual: 0,
            taxProgressive: 0, taxEffective: 0,
            salary: 0, growth: 0, investment: 0,
            passive: 0, wealth: 0
        };
        let chartInstance = null;

        // --- Formatting Utils ---
        const formatCurrency = (val) => {
            return new Intl.NumberFormat(currentCurrency === 'THB' ? 'th-TH' : 'en-US', {
                style: 'currency', currency: currentCurrency,
                minimumFractionDigits: 0, maximumFractionDigits: 0
            }).format(val);
        };

        const formatWithCommas = (val) => {
            if (!val && val !== 0 && val !== '') return "";
            const num = val.toString().replace(/,/g, '');
            if (isNaN(num)) return val;
            const parts = num.split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return parts.join('.');
        };

        // --- Animation Engine ---
        const animateValue = (id, target) => {
            const el = document.getElementById(id);
            if (!el) return;
            const start = currentValues[id] || 0;
            const duration = 1000;
            const startTime = performance.now();

            // Re-trigger animation class
            el.classList.remove('animate-bounce-up');
            void el.offsetWidth;
            el.classList.add('animate-bounce-up');

            const step = (now) => {
                const progress = Math.min((now - startTime) / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3); // Cubic Ease Out
                const current = start + (target - start) * eased;

                el.innerText = formatCurrency(current);

                if (progress < 1) {
                    requestAnimationFrame(step);
                } else {
                    currentValues[id] = target;
                    el.innerText = formatCurrency(target);
                }
            };
            requestAnimationFrame(step);
        };

        // --- Chart ---
        const initChart = () => {
            const ctx = document.getElementById('wealthChart').getContext('2d');

            // Gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(74, 222, 128, 0.2)'); // Green-400 low opacity
            gradient.addColorStop(1, 'rgba(74, 222, 128, 0)');

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'ความมั่งคั่งสะสม',
                        data: [],
                        borderColor: '#4ade80', // Green-400
                        backgroundColor: gradient,
                        borderWidth: 3,
                        pointBackgroundColor: '#4ade80',
                        fill: true,
                        tension: 0.4 // Smooth curves
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: 'rgba(255,255,255,0.1)',
                            borderWidth: 1,
                            callbacks: {
                                label: function (context) {
                                    return formatCurrency(context.raw);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false, drawBorder: false },
                            ticks: { display: false } // Hide X labels for cleaner look or reduce density
                        },
                        y: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)', drawBorder: false },
                            ticks: {
                                color: '#9ca3af',
                                callback: function (value) {
                                    return value >= 1000000 ? (value / 1000000).toFixed(1) + 'M' : (value / 1000).toFixed(0) + 'k';
                                }
                            }
                        }
                    }
                }
            });
        };

        const updateChart = (monthlyInvestment) => {
            if (!chartInstance) return;

            const years = inputs.years;
            const monthlyRate = 0.03 / 12;
            const dataPoints = [];
            const labels = [];

            let accumulated = 0;

            // Generate data points for each year
            for (let y = 1; y <= years; y++) {
                // Compound for 12 months
                for (let m = 0; m < 12; m++) {
                    accumulated = (accumulated + monthlyInvestment) * (1 + monthlyRate);
                }
                dataPoints.push(accumulated);
                labels.push(`ปีที่ ${y}`);
            }

            chartInstance.data.labels = labels;
            chartInstance.data.datasets[0].data = dataPoints;
            chartInstance.update();
        };

        const calculateThaiTax = (annualIncome) => {
            // Deductions
            const personalDeduction = 60000;
            const ssoDeduction = 9000;
            const eReceiptDeduction = 50000;
            const totalDeductions = personalDeduction + ssoDeduction + eReceiptDeduction;

            const netIncome = Math.max(0, annualIncome - totalDeductions);
            let tax = 0;

            // Brackets
            const brackets = [
                { limit: 150000, rate: 0 },
                { limit: 300000, rate: 0.05 },
                { limit: 500000, rate: 0.10 },
                { limit: 750000, rate: 0.15 },
                { limit: 1000000, rate: 0.20 },
                { limit: 2000000, rate: 0.25 },
                { limit: 5000000, rate: 0.30 },
                { limit: Infinity, rate: 0.35 }
            ];

            let remainingIncome = netIncome;
            let previousLimit = 0;

            for (const bracket of brackets) {
                if (remainingIncome <= 0) break;

                const currentChunk = Math.min(remainingIncome, bracket.limit - previousLimit);
                if (bracket.limit === Infinity) {
                    tax += remainingIncome * bracket.rate;
                } else {
                    /* Logic Check: 
                       If Bracket Limit is 150k, Previous is 0. Range is 150k.
                       If Income is 200k.
                       1. 0-150k: Chunk 150k * 0 = 0. Remaining 50k. PrevLimit 150k.
                       2. 150-300k: Chunk 50k * 0.05 = 2.5k. Remaining 0. PrevLimit 300k.
                    */
                    // Correct approach for standard iteration:
                    // Range Size = bracket.limit - previousLimit
                    // Amount in this range = min(netIncome - previousLimit, Range Size)
                    // But strictly need to check if we are IN this range.
                }
            }

            // Simpler Loop Logic
            let accumulatedTax = 0;
            let tempIncome = netIncome;

            // 0 - 150,000
            if (tempIncome > 150000) {
                tempIncome -= 150000; // 0%
            } else {
                return { tax: 0, effectiveRate: 0 };
            }

            // 150,001 - 300,000 (150k @ 5%)
            if (tempIncome > 150000) {
                accumulatedTax += 150000 * 0.05;
                tempIncome -= 150000;
            } else {
                accumulatedTax += tempIncome * 0.05;
                const eff = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
                return { tax: accumulatedTax, effectiveRate: eff };
            }

            // 300,001 - 500,000 (200k @ 10%)
            if (tempIncome > 200000) {
                accumulatedTax += 200000 * 0.10;
                tempIncome -= 200000;
            } else {
                accumulatedTax += tempIncome * 0.10;
                const eff = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
                return { tax: accumulatedTax, effectiveRate: eff };
            }

            // 500,001 - 750,000 (250k @ 15%)
            if (tempIncome > 250000) {
                accumulatedTax += 250000 * 0.15;
                tempIncome -= 250000;
            } else {
                accumulatedTax += tempIncome * 0.15;
                const eff = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
                return { tax: accumulatedTax, effectiveRate: eff };
            }

            // 750,001 - 1,000,000 (250k @ 20%)
            if (tempIncome > 250000) {
                accumulatedTax += 250000 * 0.20;
                tempIncome -= 250000;
            } else {
                accumulatedTax += tempIncome * 0.20;
                const eff = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
                return { tax: accumulatedTax, effectiveRate: eff };
            }

            // 1,000,001 - 2,000,000 (1M @ 25%)
            if (tempIncome > 1000000) {
                accumulatedTax += 1000000 * 0.25;
                tempIncome -= 1000000;
            } else {
                accumulatedTax += tempIncome * 0.25;
                const eff = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
                return { tax: accumulatedTax, effectiveRate: eff };
            }

            // 2,000,001 - 5,000,000 (3M @ 30%)
            if (tempIncome > 3000000) {
                accumulatedTax += 3000000 * 0.30;
                tempIncome -= 3000000;
            } else {
                accumulatedTax += tempIncome * 0.30;
                const eff = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
                return { tax: accumulatedTax, effectiveRate: eff };
            }

            // > 5,000,001 (Remaining @ 35%)
            accumulatedTax += tempIncome * 0.35;

            const effectiveRate = annualIncome > 0 ? ((accumulatedTax / annualIncome) * 100).toFixed(2) : 0;
            return { tax: accumulatedTax, effectiveRate: effectiveRate };
        };

        // --- Logic ---
        const calculate = () => {
            const v = parseFloat(inputs.videos.toString().replace(/,/g, '')) || 0;
            const vw = parseFloat(inputs.views.toString().replace(/,/g, '')) || 0;
            const r = parseFloat(inputs.rpm.toString().replace(/,/g, '')) || 0;

            const monthlyRevenue = ((v * 30) * vw / 1000) * r;
            const dailyRevenue = monthlyRevenue / 30;
            const annualRevenue = monthlyRevenue * 12;

            // Secondary Metrics
            const dailyViews = v * vw;
            const monthlyViews = dailyViews * 30;
            const annualViews = monthlyViews * 12;
            const monthlyVideos = v * 30;
            const annualVideos = monthlyVideos * 365; // Approx for annual display

            document.getElementById('res-daily-views').innerText = formatWithCommas(dailyViews.toFixed(0));
            document.getElementById('res-daily-rpm').innerText = formatWithCommas(r.toFixed(2));

            document.getElementById('res-monthly-views').innerText = formatWithCommas(monthlyViews.toFixed(0));
            document.getElementById('res-monthly-videos').innerText = formatWithCommas(monthlyVideos.toFixed(0));

            document.getElementById('res-annual-views').innerText = formatWithCommas(annualViews.toFixed(0));
            document.getElementById('res-annual-videos').innerText = formatWithCommas(annualVideos.toFixed(0));

            animateValue('res-daily', dailyRevenue);
            animateValue('res-monthly', monthlyRevenue);
            animateValue('res-annual', annualRevenue);

            // Tax Calculation (Thai Progressive)
            // Always convert to THB for Tax Calculation because brackets are in THB
            const annualRevenueTHB = currentCurrency === 'USD' ? annualRevenue * exchangeRate : annualRevenue;
            const taxData = calculateThaiTax(annualRevenueTHB);

            // If currently in USD, convert the resulting Tax (THB) back to USD
            const finalTax = currentCurrency === 'USD' ? taxData.tax / exchangeRate : taxData.tax;

            animateValue('res-tax-progressive', finalTax);
            document.getElementById('res-tax-effective').innerText = taxData.effectiveRate + '%';

            const salary = monthlyRevenue * 0.10;
            const growth = monthlyRevenue * 0.05;
            const investment = monthlyRevenue * 0.85;

            animateValue('alloc-salary', salary);
            animateValue('alloc-growth', growth);
            animateValue('alloc-investment', investment);

            // Projection Logic
            let currentValue = 0;
            const monthlyRate = 0.03 / 12;
            const months = inputs.years * 12;
            const principal = investment * months;

            for (let i = 0; i < months; i++) {
                currentValue = (currentValue + investment) * (1 + monthlyRate);
            }

            const monthlyPassive = (currentValue * 0.04) / 12;
            const growthPct = principal > 0 ? ((currentValue - principal) / principal * 100).toFixed(0) : 0;

            animateValue('passive-income', monthlyPassive);
            animateValue('total-wealth-Future', currentValue);
            document.getElementById('growth-percent').innerText = `+${growthPct}% GROWTH`;

            // Update labels
            document.getElementById('years-display').innerText = inputs.years;

            // Update Chart
            updateChart(investment);
        };

        // --- Event Handlers ---
        const handleInput = (key, val) => {
            const cleanVal = val.replace(/[^0-9.,]/g, '');
            const raw = cleanVal.replace(/,/g, '');
            inputs[key] = raw;
            const el = document.getElementById(`input-${key}`);
            const formatted = formatWithCommas(raw);
            if (el.value !== formatted) el.value = formatted;
            calculate();
        };

        const handleYearChange = (val) => {
            inputs.years = parseInt(val);
            calculate();
        };

        const setCurrency = (curr) => {
            if (curr === currentCurrency) return;
            const oldRpm = parseFloat(inputs.rpm.toString().replace(/,/g, '')) || 0;
            if (curr === 'THB') {
                inputs.rpm = (oldRpm * exchangeRate).toFixed(2);
                document.getElementById('btn-thb').className = "px-6 py-2 rounded-lg text-sm font-bold transition-all shadow-sm bg-white dark:bg-gray-700 text-red-500";
                document.getElementById('btn-usd').className = "px-6 py-2 rounded-lg text-sm font-bold transition-all text-gray-400 hover:text-gray-900 dark:hover:text-white";
            } else {
                inputs.rpm = (oldRpm / exchangeRate).toFixed(2);
                document.getElementById('btn-usd').className = "px-6 py-2 rounded-lg text-sm font-bold transition-all shadow-sm bg-white dark:bg-gray-700 text-red-500";
                document.getElementById('btn-thb').className = "px-6 py-2 rounded-lg text-sm font-bold transition-all text-gray-400 hover:text-gray-900 dark:hover:text-white";
            }
            currentCurrency = curr;
            document.getElementById('rpm-currency-label').innerText = curr;
            document.getElementById('input-rpm').value = formatWithCommas(inputs.rpm);
            calculate();
        };

        const toggleTheme = () => {
            document.body.parentElement.classList.toggle('dark');
            const isDark = document.body.parentElement.classList.contains('dark');
            document.getElementById('theme-icon').dataset.lucide = isDark ? 'sun' : 'moon';
            lucide.createIcons();
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        };

        // Initialize UI State
        const initUI = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.parentElement.classList.remove('dark');
                document.getElementById('theme-icon').dataset.lucide = 'moon';
            }

            // Set initial button states
            if (currentCurrency === 'THB') {
                document.getElementById('btn-thb').className = "px-6 py-2 rounded-lg text-sm font-bold transition-all shadow-sm bg-white dark:bg-gray-700 text-red-500";
            }

            // Init Spotlight Effect
            document.querySelectorAll('.glass-card').forEach(card => {
                card.addEventListener('mousemove', e => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    card.style.setProperty('--x', `${x}px`);
                    card.style.setProperty('--y', `${y}px`);
                });
            });

            lucide.createIcons();
            initChart(); // Init chart before calculating
            calculate();
        };

        // Wait for chart.js to load if needed, but usually safe to call in module or end of body
        window.addEventListener('load', initUI);

    </script>
</body>

</html>